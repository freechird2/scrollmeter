(function(T,v){typeof exports=="object"&&typeof module<"u"?v(exports,require("react")):typeof define=="function"&&define.amd?define(["exports","react"],v):(T=typeof globalThis<"u"?globalThis:T||self,v(T.ScrollMeter={},T.React))})(this,function(T,v){"use strict";var me=e=>{throw TypeError(e)},se=(e,t,r)=>t.has(e)||me("Cannot "+r),l=(e,t,r)=>(se(e,t,"read from private field"),r?r.call(e):t.get(e)),u=(e,t,r)=>t.has(e)?me("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),a=(e,t,r,n)=>(se(e,t,"write to private field"),t.set(e,r),r),Re=(e,t,r)=>(se(e,t,"access private method"),r);function Oe(e,t){if(e.match(/^[a-z]+:\/\//i))return e;if(e.match(/^\/\//))return window.location.protocol+e;if(e.match(/^[a-z]+:/i))return e;const r=document.implementation.createHTMLDocument(),n=r.createElement("base"),i=r.createElement("a");return r.head.appendChild(n),r.body.appendChild(i),t&&(n.href=t),i.href=e,i.href}const We=(()=>{let e=0;const t=()=>`0000${(Math.random()*36**4<<0).toString(36)}`.slice(-4);return()=>(e+=1,`u${t()}${e}`)})();function E(e){const t=[];for(let r=0,n=e.length;r<n;r++)t.push(e[r]);return t}function z(e,t){const r=(e.ownerDocument.defaultView||window).getComputedStyle(e).getPropertyValue(t);return r?parseFloat(r.replace("px","")):0}function Le(e){const t=z(e,"border-left-width"),r=z(e,"border-right-width");return e.clientWidth+t+r}function Ie(e){const t=z(e,"border-top-width"),r=z(e,"border-bottom-width");return e.clientHeight+t+r}function pe(e,t={}){const r=t.width||Le(e),n=t.height||Ie(e);return{width:r,height:n}}function Ae(){let e,t;try{t=process}catch{}const r=t&&t.env?t.env.devicePixelRatio:null;return r&&(e=parseInt(r,10),Number.isNaN(e)&&(e=1)),e||window.devicePixelRatio||1}const C=16384;function He(e){(e.width>C||e.height>C)&&(e.width>C&&e.height>C?e.width>e.height?(e.height*=C/e.width,e.width=C):(e.width*=C/e.height,e.height=C):e.width>C?(e.height*=C/e.width,e.width=C):(e.width*=C/e.height,e.height=C))}function B(e){return new Promise((t,r)=>{const n=new Image;n.decode=()=>t(n),n.onload=()=>t(n),n.onerror=r,n.crossOrigin="anonymous",n.decoding="async",n.src=e})}async function Ne(e){return Promise.resolve().then(()=>new XMLSerializer().serializeToString(e)).then(encodeURIComponent).then(t=>`data:image/svg+xml;charset=utf-8,${t}`)}async function De(e,t,r){const n="http://www.w3.org/2000/svg",i=document.createElementNS(n,"svg"),o=document.createElementNS(n,"foreignObject");return i.setAttribute("width",`${t}`),i.setAttribute("height",`${r}`),i.setAttribute("viewBox",`0 0 ${t} ${r}`),o.setAttribute("width","100%"),o.setAttribute("height","100%"),o.setAttribute("x","0"),o.setAttribute("y","0"),o.setAttribute("externalResourcesRequired","true"),i.appendChild(o),o.appendChild(e),Ne(i)}const y=(e,t)=>{if(e instanceof t)return!0;const r=Object.getPrototypeOf(e);return r===null?!1:r.constructor.name===t.name||y(r,t)};function Ve(e){const t=e.getPropertyValue("content");return`${e.cssText} content: '${t.replace(/'|"/g,"")}';`}function Fe(e){return E(e).map(t=>{const r=e.getPropertyValue(t),n=e.getPropertyPriority(t);return`${t}: ${r}${n?" !important":""};`}).join(" ")}function ze(e,t,r){const n=`.${e}:${t}`,i=r.cssText?Ve(r):Fe(r);return document.createTextNode(`${n}{${i}}`)}function fe(e,t,r){const n=window.getComputedStyle(e,r),i=n.getPropertyValue("content");if(i===""||i==="none")return;const o=We();try{t.className=`${t.className} ${o}`}catch{return}const s=document.createElement("style");s.appendChild(ze(o,r,n)),t.appendChild(s)}function Be(e,t){fe(e,t,":before"),fe(e,t,":after")}const ge="application/font-woff",we="image/jpeg",qe={woff:ge,woff2:ge,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:we,jpeg:we,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml",webp:"image/webp"};function je(e){const t=/\.([^./]*?)$/g.exec(e);return t?t[1]:""}function le(e){const t=je(e).toLowerCase();return qe[t]||""}function Ue(e){return e.split(/,/)[1]}function ce(e){return e.search(/^(data:)/)!==-1}function Ye(e,t){return`data:${t};base64,${e}`}async function ye(e,t,r){const n=await fetch(e,t);if(n.status===404)throw new Error(`Resource "${n.url}" not found`);const i=await n.blob();return new Promise((o,s)=>{const c=new FileReader;c.onerror=s,c.onloadend=()=>{try{o(r({res:n,result:c.result}))}catch(h){s(h)}},c.readAsDataURL(i)})}const ae={};function Xe(e,t,r){let n=e.replace(/\?.*/,"");return r&&(n=e),/ttf|otf|eot|woff2?/i.test(n)&&(n=n.replace(/.*\//,"")),t?`[${t}]${n}`:n}async function he(e,t,r){const n=Xe(e,t,r.includeQueryParams);if(ae[n]!=null)return ae[n];r.cacheBust&&(e+=(/\?/.test(e)?"&":"?")+new Date().getTime());let i;try{const o=await ye(e,r.fetchRequestInit,({res:s,result:c})=>(t||(t=s.headers.get("Content-Type")||""),Ue(c)));i=Ye(o,t)}catch(o){i=r.imagePlaceholder||"";let s=`Failed to fetch resource: ${e}`;o&&(s=typeof o=="string"?o:o.message),s&&console.warn(s)}return ae[n]=i,i}async function Je(e){const t=e.toDataURL();return t==="data:,"?e.cloneNode(!1):B(t)}async function Ge(e,t){if(e.currentSrc){const o=document.createElement("canvas"),s=o.getContext("2d");o.width=e.clientWidth,o.height=e.clientHeight,s==null||s.drawImage(e,0,0,o.width,o.height);const c=o.toDataURL();return B(c)}const r=e.poster,n=le(r),i=await he(r,n,t);return B(i)}async function Qe(e){var t;try{if(!((t=e==null?void 0:e.contentDocument)===null||t===void 0)&&t.body)return await q(e.contentDocument.body,{},!0)}catch{}return e.cloneNode(!1)}async function Ke(e,t){return y(e,HTMLCanvasElement)?Je(e):y(e,HTMLVideoElement)?Ge(e,t):y(e,HTMLIFrameElement)?Qe(e):e.cloneNode(!1)}const Ze=e=>e.tagName!=null&&e.tagName.toUpperCase()==="SLOT";async function et(e,t,r){var n,i;let o=[];return Ze(e)&&e.assignedNodes?o=E(e.assignedNodes()):y(e,HTMLIFrameElement)&&!((n=e.contentDocument)===null||n===void 0)&&n.body?o=E(e.contentDocument.body.childNodes):o=E(((i=e.shadowRoot)!==null&&i!==void 0?i:e).childNodes),o.length===0||y(e,HTMLVideoElement)||await o.reduce((s,c)=>s.then(()=>q(c,r)).then(h=>{h&&t.appendChild(h)}),Promise.resolve()),t}function tt(e,t){const r=t.style;if(!r)return;const n=window.getComputedStyle(e);n.cssText?(r.cssText=n.cssText,r.transformOrigin=n.transformOrigin):E(n).forEach(i=>{let o=n.getPropertyValue(i);i==="font-size"&&o.endsWith("px")&&(o=`${Math.floor(parseFloat(o.substring(0,o.length-2)))-.1}px`),y(e,HTMLIFrameElement)&&i==="display"&&o==="inline"&&(o="block"),i==="d"&&t.getAttribute("d")&&(o=`path(${t.getAttribute("d")})`),r.setProperty(i,o,n.getPropertyPriority(i))})}function nt(e,t){y(e,HTMLTextAreaElement)&&(t.innerHTML=e.value),y(e,HTMLInputElement)&&t.setAttribute("value",e.value)}function rt(e,t){if(y(e,HTMLSelectElement)){const r=t,n=Array.from(r.children).find(i=>e.value===i.getAttribute("value"));n&&n.setAttribute("selected","")}}function it(e,t){return y(t,Element)&&(tt(e,t),Be(e,t),nt(e,t),rt(e,t)),t}async function ot(e,t){const r=e.querySelectorAll?e.querySelectorAll("use"):[];if(r.length===0)return e;const n={};for(let o=0;o<r.length;o++){const s=r[o].getAttribute("xlink:href");if(s){const c=e.querySelector(s),h=document.querySelector(s);!c&&h&&!n[s]&&(n[s]=await q(h,t,!0))}}const i=Object.values(n);if(i.length){const o="http://www.w3.org/1999/xhtml",s=document.createElementNS(o,"svg");s.setAttribute("xmlns",o),s.style.position="absolute",s.style.width="0",s.style.height="0",s.style.overflow="hidden",s.style.display="none";const c=document.createElementNS(o,"defs");s.appendChild(c);for(let h=0;h<i.length;h++)c.appendChild(i[h]);e.appendChild(s)}return e}async function q(e,t,r){return!r&&t.filter&&!t.filter(e)?null:Promise.resolve(e).then(n=>Ke(n,t)).then(n=>et(e,n,t)).then(n=>it(e,n)).then(n=>ot(n,t))}const _e=/url\((['"]?)([^'"]+?)\1\)/g,st=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,lt=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function ct(e){const t=e.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${t})(['"]?\\))`,"g")}function at(e){const t=[];return e.replace(_e,(r,n,i)=>(t.push(i),r)),t.filter(r=>!ce(r))}async function ht(e,t,r,n,i){try{const o=r?Oe(t,r):t,s=le(t);let c;return i||(c=await he(o,s,n)),e.replace(ct(t),`$1${c}$3`)}catch{}return e}function ut(e,{preferredFontFormat:t}){return t?e.replace(lt,r=>{for(;;){const[n,,i]=st.exec(r)||[];if(!i)return"";if(i===t)return`src: ${n};`}}):e}function Ce(e){return e.search(_e)!==-1}async function Se(e,t,r){if(!Ce(e))return e;const n=ut(e,r);return at(n).reduce((i,o)=>i.then(s=>ht(s,o,t,r)),Promise.resolve(n))}async function j(e,t,r){var n;const i=(n=t.style)===null||n===void 0?void 0:n.getPropertyValue(e);if(i){const o=await Se(i,null,r);return t.style.setProperty(e,o,t.style.getPropertyPriority(e)),!0}return!1}async function dt(e,t){await j("background",e,t)||await j("background-image",e,t),await j("mask",e,t)||await j("mask-image",e,t)}async function mt(e,t){const r=y(e,HTMLImageElement);if(!(r&&!ce(e.src))&&!(y(e,SVGImageElement)&&!ce(e.href.baseVal)))return;const n=r?e.src:e.href.baseVal,i=await he(n,le(n),t);await new Promise((o,s)=>{e.onload=o,e.onerror=s;const c=e;c.decode&&(c.decode=o),c.loading==="lazy"&&(c.loading="eager"),r?(e.srcset="",e.src=i):e.href.baseVal=i})}async function pt(e,t){const r=E(e.childNodes).map(n=>ve(n,t));await Promise.all(r).then(()=>e)}async function ve(e,t){y(e,Element)&&(await dt(e,t),await mt(e,t),await pt(e,t))}function ft(e,t){const{style:r}=e;t.backgroundColor&&(r.backgroundColor=t.backgroundColor),t.width&&(r.width=`${t.width}px`),t.height&&(r.height=`${t.height}px`);const n=t.style;return n!=null&&Object.keys(n).forEach(i=>{r[i]=n[i]}),e}const be={};async function Ee(e){let t=be[e];if(t!=null)return t;const r=await(await fetch(e)).text();return t={url:e,cssText:r},be[e]=t,t}async function xe(e,t){let r=e.cssText;const n=/url\(["']?([^"')]+)["']?\)/g,i=(r.match(/url\([^)]+\)/g)||[]).map(async o=>{let s=o.replace(n,"$1");return s.startsWith("https://")||(s=new URL(s,e.url).href),ye(s,t.fetchRequestInit,({result:c})=>(r=r.replace(o,`url(${c})`),[o,c]))});return Promise.all(i).then(()=>r)}function Te(e){if(e==null)return[];const t=[],r=/(\/\*[\s\S]*?\*\/)/gi;let n=e.replace(r,"");const i=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");for(;;){const h=i.exec(n);if(h===null)break;t.push(h[0])}n=n.replace(i,"");const o=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,s="((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})",c=new RegExp(s,"gi");for(;;){let h=o.exec(n);if(h===null){if(h=c.exec(n),h===null)break;o.lastIndex=c.lastIndex}else c.lastIndex=o.lastIndex;t.push(h[0])}return t}async function gt(e,t){const r=[],n=[];return e.forEach(i=>{if("cssRules"in i)try{E(i.cssRules||[]).forEach((o,s)=>{if(o.type===CSSRule.IMPORT_RULE){let c=s+1;const h=o.href,w=Ee(h).then(d=>xe(d,t)).then(d=>Te(d).forEach(p=>{try{i.insertRule(p,p.startsWith("@import")?c+=1:i.cssRules.length)}catch(k){console.error("Error inserting rule from remote css",{rule:p,error:k})}})).catch(d=>{console.error("Error loading remote css",d.toString())});n.push(w)}})}catch(o){const s=e.find(c=>c.href==null)||document.styleSheets[0];i.href!=null&&n.push(Ee(i.href).then(c=>xe(c,t)).then(c=>Te(c).forEach(h=>{s.insertRule(h,i.cssRules.length)})).catch(c=>{console.error("Error loading remote stylesheet",c)})),console.error("Error inlining remote css file",o)}}),Promise.all(n).then(()=>(e.forEach(i=>{if("cssRules"in i)try{E(i.cssRules||[]).forEach(o=>{r.push(o)})}catch(o){console.error(`Error while reading CSS rules from ${i.href}`,o)}}),r))}function wt(e){return e.filter(t=>t.type===CSSRule.FONT_FACE_RULE).filter(t=>Ce(t.style.getPropertyValue("src")))}async function yt(e,t){if(e.ownerDocument==null)throw new Error("Provided element is not within a Document");const r=E(e.ownerDocument.styleSheets),n=await gt(r,t);return wt(n)}async function _t(e,t){const r=await yt(e,t);return(await Promise.all(r.map(n=>{const i=n.parentStyleSheet?n.parentStyleSheet.href:null;return Se(n.cssText,i,t)}))).join(`
`)}async function Ct(e,t){const r=t.fontEmbedCSS!=null?t.fontEmbedCSS:t.skipFonts?null:await _t(e,t);if(r){const n=document.createElement("style"),i=document.createTextNode(r);n.appendChild(i),e.firstChild?e.insertBefore(n,e.firstChild):e.appendChild(n)}}async function St(e,t={}){const{width:r,height:n}=pe(e,t),i=await q(e,t,!0);return await Ct(i,t),await ve(i,t),ft(i,t),await De(i,r,n)}async function vt(e,t={}){const{width:r,height:n}=pe(e,t),i=await St(e,t),o=await B(i),s=document.createElement("canvas"),c=s.getContext("2d"),h=t.pixelRatio||Ae(),w=t.canvasWidth||r,d=t.canvasHeight||n;return s.width=w*h,s.height=d*h,t.skipAutoScale||He(s),s.style.width=`${w}`,s.style.height=`${d}`,t.backgroundColor&&(c.fillStyle=t.backgroundColor,c.fillRect(0,0,s.width,s.height)),c.drawImage(o,0,0,s.width,s.height),s}const bt="scrollmeter-module__scrollmeter_container___Jfedd",Et="scrollmeter-module__scrollmeter_container___Jfedd",xt="scrollmeter-module__scrollmeter_bar___p8v2h",Tt="scrollmeter-module__scrollmeter_bar___p8v2h",kt="scrollmeter-module__scrollmeter_timeline___he3FL",Pt="scrollmeter-module__scrollmeter_timeline___he3FL",Mt="scrollmeter-module__scrollmeter_timeline_tooltip___6ORWv",$t="scrollmeter-module__scrollmeter_timeline_tooltip___6ORWv",Rt="scrollmeter-module__scrollmeter_timeline_tooltip_left___TU1Oc",Ot="scrollmeter-module__scrollmeter_timeline_tooltip_left___TU1Oc",Wt="scrollmeter-module__scrollmeter_timeline_tooltip_right___ogXqk",Lt="scrollmeter-module__scrollmeter_timeline_tooltip_right___ogXqk",It="scrollmeter-module__scrollmeter_timeline_tooltip_center___rVCHc",At="scrollmeter-module__scrollmeter_timeline_tooltip_center___rVCHc",Ht="scrollmeter-module__scrollmeter_timeline_preview___FqLou",Nt="scrollmeter-module__scrollmeter_timeline_preview___FqLou",x={scrollmeter_container:bt,scrollmeterContainer:Et,scrollmeter_bar:xt,scrollmeterBar:Tt,scrollmeter_timeline:kt,scrollmeterTimeline:Pt,scrollmeter_timeline_tooltip:Mt,scrollmeterTimelineTooltip:$t,scrollmeter_timeline_tooltip_left:Rt,scrollmeterTimelineTooltipLeft:Ot,scrollmeter_timeline_tooltip_right:Wt,scrollmeterTimelineTooltipRight:Lt,scrollmeter_timeline_tooltip_center:It,scrollmeterTimelineTooltipCenter:At,scrollmeter_timeline_preview:Ht,scrollmeterTimelinePreview:Nt};class ue{}var S,U,Y;class ke extends ue{constructor(t){super(),u(this,S),u(this,U),u(this,Y),a(this,U,(r,n=320)=>{const i=l(this,S).getCaptureCanvas(),o=l(this,S).getCanvasRatio();if(!i)return;const s=i.width,c=s*9/16,h=Math.max(0,r.getBoundingClientRect().top*o+window.scrollY*o-c/2),w=n*9/16,d=document.createElement("canvas");d.width=n,d.height=w;const p=d.getContext("2d");return p?(p.drawImage(i,0,Math.max(0,Math.min(h,i.height-c)),s,c,0,0,n,w),d.toDataURL()):null}),a(this,Y,r=>{const n=document.createElement("div");n.classList.add(x.scrollmeter_timeline_preview);const i=new Image;return i.src=r,n.appendChild(i),n}),this.createTimelineTooltip=(r,n,i)=>{if(!n.textContent)return;const o=document.createElement("div"),s=document.createElement("p");if(l(this,S).getDefaultOptions().usePreview){const c=l(this,U).call(this,n);if(c){const h=l(this,Y).call(this,c);o.appendChild(h)}}return o.classList.add(x.scrollmeter_timeline_tooltip),o.classList.add(x[`scrollmeter_timeline_tooltip_${i}`]),s.textContent=n.textContent,o.appendChild(s),this.setCSSCustomProperties(),r.appendChild(o),o},a(this,S,t)}setCSSCustomProperties(){var t,r,n,i,o,s;const c=l(this,S).getDefaultOptions();if(c&&c.tooltipOptions){const{background:h,fontColor:w,fontSize:d,paddingBlock:p,paddingInline:k,width:oe}=c.tooltipOptions;h&&((t=l(this,S).getScrollmeterContainer())==null||t.style.setProperty("--scrollmeter-tooltip-background",h)),w&&((r=l(this,S).getScrollmeterContainer())==null||r.style.setProperty("--scrollmeter-tooltip-font-color",w)),d&&((n=l(this,S).getScrollmeterContainer())==null||n.style.setProperty("--scrollmeter-tooltip-font-size",`${d}px`)),p&&((i=l(this,S).getScrollmeterContainer())==null||i.style.setProperty("--scrollmeter-tooltip-padding-block",`${p}px`)),k&&((o=l(this,S).getScrollmeterContainer())==null||o.style.setProperty("--scrollmeter-tooltip-padding-inline",`${k}px`)),oe&&((s=l(this,S).getScrollmeterContainer())==null||s.style.setProperty("--scrollmeter-tooltip-width",`${oe}px`))}}}S=new WeakMap,U=new WeakMap,Y=new WeakMap;var _,X,de,Pe;class Me extends ue{constructor(t){super(),u(this,de),u(this,_),u(this,X),a(this,X,r=>{const n=[],i=o=>{o.tagName.toLowerCase()==="h1"&&Re(this,de,Pe).call(this,o)&&n.push(o),Array.from(o.children).forEach(s=>{i(s)})};return i(r),n}),this.createTimeline=r=>{var n;const i=l(this,_).getTargetContainer();if(!i)return null;const o=l(this,X).call(this,i);if(o.length===0)return null;const s=((n=l(this,_).getDefaultOptions().timelineOptions)==null?void 0:n.width)??4;let c=o.length;return o.map(h=>{var w;const d=l(this,_).getTargetContainer();if(!d)return;const p=document.createElement("div");p.classList.add(x.scrollmeter_timeline);const k=h.getBoundingClientRect().top+window.scrollY,oe=d.getBoundingClientRect().top+window.scrollY,zt=k-oe,$e=d.clientHeight-document.documentElement.clientHeight;if(p.style.zIndex=r.toString(),p.addEventListener("pointerdown",()=>{h.scrollIntoView({behavior:"smooth"})}),$e>k){const b=zt/$e*100;p.style.left=`${b>100?`calc(100% - ${s}px)`:`${b}%`}`,l(this,_).getDefaultOptions().useTooltip&&new ke(l(this,_)).createTimelineTooltip(p,h,b<=16?"left":b>=83?"right":"center")}else if(p.style.left=`calc(100% - ${s*(c--*4)}px)`,l(this,_).getDefaultOptions().useTooltip){const b=new ke(l(this,_)).createTimelineTooltip(p,h,"right");b.addEventListener("touchstart",function(){b.style.visibility="visible",b.style.opacity="1",setTimeout(()=>{b.style.visibility="hidden",b.style.opacity="0"},1e3)})}(w=l(this,_).getScrollmeterContainer())==null||w.appendChild(p)}),this.setCSSCustomProperties(),this},a(this,_,t)}setCSSCustomProperties(){var t,r;const n=l(this,_).getDefaultOptions();if(n&&n.timelineOptions){const{color:i,width:o}=n.timelineOptions;i&&((t=l(this,_).getScrollmeterContainer())==null||t.style.setProperty("--scrollmeter-timeline-color",i)),o&&((r=l(this,_).getScrollmeterContainer())==null||r.style.setProperty("--scrollmeter-timeline-width",`${o}px`))}}}_=new WeakMap,X=new WeakMap,de=new WeakSet,Pe=function(e){const t=window.getComputedStyle(e);if(t.display==="none"||t.visibility==="hidden"||t.opacity==="0")return!1;let r=e.parentElement;for(;r;){const n=window.getComputedStyle(r);if(n.display==="none"||n.visibility==="hidden"||n.opacity==="0")return!1;r=r.parentElement}return!0};var g,m,f,P,M,$,L,I,A,H,N,R,D,V,O,J,G,Q,F,W,K,Z,ee,te,ne,re,ie;class Dt extends ue{constructor(t){super(),u(this,g),u(this,m),u(this,f),u(this,P),u(this,M),u(this,$),u(this,L),u(this,I),u(this,A),u(this,H),u(this,N),u(this,R),u(this,D),u(this,V),u(this,O),u(this,J),u(this,G),u(this,Q),u(this,F),u(this,W),u(this,K),u(this,Z),u(this,ee),u(this,te),u(this,ne),u(this,re),u(this,ie),a(this,J,()=>{if(!l(this,m))throw new Error("targetContainer is not found");a(this,M,new ResizeObserver(async i=>{l(this,m)&&(!l(this,f)||l(this,I)===i[0].contentRect.height||(a(this,I,i[0].contentRect.height),this.render(l(this,g))))}))}),a(this,G,()=>{try{if(!l(this,m))throw new Error("targetContainer is not found");const i=document.createElement("div");i.classList.add(x.scrollmeter_container);const o=l(this,F).call(this,l(this,m));a(this,R,o),i.style.zIndex=o.toString();const s=l(this,Q).call(this);return i.appendChild(s),a(this,f,i),this.setCSSCustomProperties(),i}catch(i){console.error(i)}}),a(this,Q,()=>{const i=document.createElement("div");return i.classList.add(x.scrollmeter_bar),a(this,P,i),i}),a(this,F,i=>{let o=0;const s=window.getComputedStyle(i).zIndex;return s!=="auto"&&(o=Math.max(o,parseInt(s))),Array.from(i.children).forEach(c=>{o=Math.max(o,l(this,F).call(this,c))}),o+1}),a(this,W,()=>{if(!l(this,m)||!l(this,O))return;if(!l(this,ee).call(this)){l(this,f).style.opacity="0";return}l(this,f).style.opacity="1";const i=(window.scrollY-l(this,N))/l(this,H)*100;a(this,A,Math.min(100,Math.max(0,i))),l(this,P)&&(l(this,P).style.width=`${l(this,A)}%`)}),a(this,K,(i,o)=>{let s=!1;return()=>{s||(i.apply(this),s=!0,setTimeout(()=>{s=!1},o))}}),a(this,Z,l(this,K).call(this,l(this,W),8)),a(this,ee,()=>l(this,m)?l(this,m).getBoundingClientRect().top<=0&&l(this,m).getBoundingClientRect().bottom>0:!1),a(this,te,(i,o)=>{let s=null;return(...c)=>{s&&clearTimeout(s),s=setTimeout(()=>{i.apply(this,c),s=null},o)}}),a(this,ne,l(this,te).call(this,async()=>{if(l(this,g).usePreview){await l(this,re).call(this);const i=new Me(this);a(this,$,i.createTimeline(l(this,R)))}},300)),a(this,re,async()=>{if(l(this,m))try{const i=Math.max(document.documentElement.scrollWidth,document.documentElement.offsetWidth,document.documentElement.clientWidth),o=Math.max(document.documentElement.scrollHeight,document.documentElement.offsetHeight,document.documentElement.clientHeight);await new Promise(c=>setTimeout(c,100));const s=await vt(document.documentElement,{width:i,height:o,filter:c=>{var h;return!(c instanceof HTMLElement&&(h=c.classList)!=null&&h.contains(x.scrollmeter_container))},backgroundColor:getComputedStyle(document.body).backgroundColor||"#ffffff"});return a(this,D,i),a(this,V,s.width),a(this,L,s),s}catch(i){return console.error("미리보기 생성 중 오류 발생:",i),null}}),a(this,ie,()=>{try{if(!l(this,m))throw new Error("targetContainer is not found");if(document.querySelectorAll(`.${x.scrollmeter_container}`).length>0)return null;if(!l(this,M))throw new Error("resizeObserver is not found");const i=l(this,G).call(this);if(!i)throw new Error("scrollmetercontainer is not found");l(this,m).appendChild(i),l(this,M).observe(l(this,m)),new IntersectionObserver(o=>{o.forEach(s=>{s.isIntersecting?(a(this,O,!0),l(this,W).call(this)):a(this,O,!1)})}).observe(l(this,m)),window.addEventListener("scroll",l(this,Z))}catch(i){console.error(i)}}),this.setCSSCustomProperties=()=>{if(l(this,f)&&l(this,g).barOptions){const{color:i,background:o,height:s}=l(this,g).barOptions;i&&l(this,f).style.setProperty("--scrollmeter-bar-color",i),o&&l(this,f).style.setProperty("--scrollmeter-bar-background",o),s&&l(this,f).style.setProperty("--scrollmeter-bar-height",`${s}px`)}},this.getTargetContainer=()=>l(this,m),this.getScrollmeterContainer=()=>l(this,f),this.getCaptureCanvas=()=>l(this,L)||null,this.getCanvasRatio=()=>l(this,V)/l(this,D),this.getDefaultOptions=()=>l(this,g),this.render=i=>{a(this,g,{...l(this,g),...i});const o=parseInt(window.getComputedStyle(l(this,m)).marginTop),s=parseInt(window.getComputedStyle(l(this,m)).marginBottom);if(a(this,N,window.scrollY+l(this,m).getBoundingClientRect().top),a(this,H,l(this,m).clientHeight+o+s-document.documentElement.clientHeight),l(this,W).call(this),l(this,g).useTimeline)if(document.querySelectorAll(`.${x.scrollmeter_timeline}`).forEach(c=>{c.remove()}),l(this,g).usePreview)l(this,ne).call(this);else{const c=new Me(this);a(this,$,c.createTimeline(l(this,R)))}},this.updateScrollmeterStyle=i=>{var o;if(a(this,g,{...l(this,g),...i}),this.setCSSCustomProperties(),(o=l(this,$))==null||o.setCSSCustomProperties(),l(this,g)&&l(this,g).tooltipOptions){const{background:s,fontColor:c,fontSize:h,paddingBlock:w,paddingInline:d,width:p}=l(this,g).tooltipOptions;s&&l(this,f).style.setProperty("--scrollmeter-tooltip-background",s),c&&l(this,f).style.setProperty("--scrollmeter-tooltip-font-color",c),h&&l(this,f).style.setProperty("--scrollmeter-tooltip-font-size",`${h}px`),w&&l(this,f).style.setProperty("--scrollmeter-tooltip-padding-block",`${w}px`),d&&l(this,f).style.setProperty("--scrollmeter-tooltip-padding-inline",`${d}px`),p&&l(this,f).style.setProperty("--scrollmeter-tooltip-width",`${p}px`)}};const{targetId:r,target:n}=t;a(this,g,t),a(this,m,r?document.getElementById(r):typeof n=="string"?document.getElementById(n):n??null),a(this,f,null),a(this,P,null),a(this,M,null),a(this,L,null),a(this,$,null),a(this,I,0),a(this,A,0),a(this,H,0),a(this,N,0),a(this,R,0),a(this,D,0),a(this,V,0),a(this,O,!1),l(this,J).call(this),l(this,ie).call(this)}}g=new WeakMap,m=new WeakMap,f=new WeakMap,P=new WeakMap,M=new WeakMap,$=new WeakMap,L=new WeakMap,I=new WeakMap,A=new WeakMap,H=new WeakMap,N=new WeakMap,R=new WeakMap,D=new WeakMap,V=new WeakMap,O=new WeakMap,J=new WeakMap,G=new WeakMap,Q=new WeakMap,F=new WeakMap,W=new WeakMap,K=new WeakMap,Z=new WeakMap,ee=new WeakMap,te=new WeakMap,ne=new WeakMap,re=new WeakMap,ie=new WeakMap;const Vt=e=>{try{return new Dt(e)}catch(t){return console.error(t),null}};function Ft(e){const t=v.useRef(null),r=v.useRef(null),n=v.useMemo(()=>({...e,barOptions:{...e.barOptions},tooltipOptions:{...e.tooltipOptions},timelineOptions:{...e.timelineOptions}}),[e]);return v.useEffect(()=>{r.current&&r.current.render(e)},[n.usePreview,n.useTimeline,n.useTooltip]),v.useEffect(()=>{r.current&&r.current.updateScrollmeterStyle(n)},[n.barOptions,n.tooltipOptions,n.timelineOptions]),v.useEffect(()=>{!t.current||r.current||(r.current=Vt({target:t.current,...e}))},[t.current]),{targetRef:t}}T.useScrollmeter=Ft,Object.defineProperty(T,Symbol.toStringTag,{value:"Module"})});
